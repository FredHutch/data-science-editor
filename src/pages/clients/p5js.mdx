---
title: p5.jacdac
weight: 4
---

# p5.jacdac, a p5.js library for Jacdac

**p5.jacdac** integrates Jacdac with [p5.js](https://p5js.org) to create creative coding with physical devices
with installing any drivers!

-   no driver or installation needed
-   just works from your browser

## Support for WebUSB, WebSerial

-   in the [online p5.js editor](https://editor.p5js.org/), only WebSerial is supported
-   in CodeSandbox, only WebUSB is supported
-   running p5.js locally? everything is possible!

## Usage

Download the [p5.jacdac library](https://unpkg.com/jacdac-ts/dist/p5.jacdac.js) or use the online version (recommended) and add it to the head section of your HTML document.

```html
<script src="https://unpkg.com/jacdac-ts/dist/p5.jacdac.js"></script>
```

or

```html
<script src="./p5.jacdac.js"></script>
```

```html
<html>
    <head>
        ...
        <script src="https://unpkg.com/jacdac-ts/dist/p5.jacdac.js"></script>
    </head>
    ...
</html>
```

That's it! `p5.jacdac` will automatically show a button to connect to your
device and hide it when connected.

## Sensors

The state of all sensor readings connected to the bus can be access through the `jacdac.sensors` object.
The readings are grouped into per service type and keyed with the service camel name (`button`, `potentiometer`, ...).

### Single value sensors

For sensors with a single numerical value, like a thermometer, readings are grouped in a `number` array. To access the readings, start by extracting the [service](/services) data you want.

```javascript
// grabs an array with all potentiometer readings (number[]) connected to jacdac
const { potentiometer } = jacdac.sensors
```

Then map the reading to local variables. Depending on the number of connected sensors,
some value will be undefined so make sure to assign defaults.

```javascript
// destructure readings into r,g,b variables
// if sensors are missing, default to 0
const [r = 0, g = 0, b = 0] = potentiometer
```

Use those values any way you want!

```p5js
// rescale 0..1 to 0..255 and repaint background
background(r * 255, g * 255, b * 255)
-----
function setup() {
    createCanvas(400, 400)
}
function draw() {
    // grabs an array with all potentiometer readings (number[]) connected to jacdac
    const { potentiometer } = jacdac.sensors
    // destructure readings into r,g,b variables
    // if sensors are missing, default to 0
    const [r = 0, g = 0, b = 0] = potentiometer
    // rescale 0..1 to 0..255 to repaint background
    background(r * 255, g * 255, b * 255)
}
```

## Composite value sensors

For sensors with multiple values, like an accelerometer returning a 3D force, readings are grouped in an object array
indexed by the field names.

```javascript
const { accelerometer } = jacdac.sensors
const [acceleration] = accelerometer
// the acceleration is stored as a ``{ x: .., y: ..., z: ... }`` object
// add ``|| {}`` to handle missing data
const { x: ax, y: ay, z: az } = acceleration || {}
```

## Enumerating sensors

If you do not know the number of sensors ahead of time, you can use a `for` loop
to iterate the list of readings.

```p5js
for (const acceleration of accelerometer) {
    const { x: ax = 0, y: ay = 0, z: az = 0 } = acceleration
    ...
}
-----
function setup() {
    createCanvas(400, 400)
}
function draw() {
    const { accelerometer } = jacdac.sensors
    // the acceleration is stored as a ``{ x: .., y: ..., z: ... }`` object
    for(const acceleration of accelerometer) {
        const { x: ax = 0, y: ay = 0, z: az = 0 } = acceleration
        // map g (gravities) to 100..300 on canvas
        const x = map(ax, -1, 1, 100, 300)
        const y = map(ay, -1, 1, 100, 300)
        const d = map(az, -1, 1, 5, 50)
        // draw point
        stroke('white')
        circle(x, y, d)
    }
}
```
